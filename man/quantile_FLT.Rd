% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/quantile_FLT.R
\name{quantile_FLT}
\alias{quantile_FLT}
\title{Quantile Functional Linear Test (FLT) for GLS Spectrum Regression}
\usage{
quantile_FLT(spectrum_obj, a, b)
}
\arguments{
\item{spectrum_obj}{An object returned by \code{\link{wasserstein_spectrum}}, which contains
basis matrix, coefficient estimates, robust covariance matrix, and other fitting information.}

\item{a}{Lower bound of the quantile interval (e.g., 0.25).}

\item{b}{Upper bound of the quantile interval (e.g., 0.75).}
}
\value{
A list containing:
\item{a}{Lower bound of the tested quantile interval.}
\item{b}{Upper bound of the tested quantile interval.}
\item{delta}{Estimated integral of \(\hat{\beta}_1(t)\) over \([a, b]\).}
\item{se}{Estimated standard error of the integral.}
\item{z}{Wald test statistic.}
\item{p}{Two-sided p-value for the test.}
}
\description{
Performs a Wald-type integral test to assess whether the estimated coefficient curve
\eqn{\beta_1(t)} is significantly different from zero over a specified quantile interval
\eqn{[a, b]}. This test is based on the output of \code{\link{wasserstein_spectrum}}.
}
\details{
The function computes the test statistic:
\deqn{
Z = \frac{\int_a^b \hat{\beta}_1(t) dt}{\sqrt{\mathrm{Var}\left( \int_a^b \hat{\beta}_1(t) dt \right)}}
}
using the B-spline basis expansion and robust sandwich variance estimates from the
generalized least squares spectrum fit.

The integral is approximated using a Riemann sum over the B-spline basis,
and the variance of the integral is computed using the delta method.
}
\examples{
\dontrun{
fit <- wasserstein_spectrum(df = example_df,
                                feature_col = "Shannon",
                                outcome_col = "BMI",
                                confounder_cols = c("Age", "Sex"))
flt_result <- quantile_FLT(fit, a = 0.25, b = 0.75)
print(flt_result$p)
}

}
