% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/wasserstein_quantile_test.R
\name{wasserstein_quantile_test}
\alias{wasserstein_quantile_test}
\title{Wasserstein Quantile-Based Inference for Microbiome Data}
\usage{
wasserstein_quantile_test(
  df,
  metadata,
  outcome_col,
  confounder_cols = NULL,
  basis_df = 6,
  t_grid = seq(0.01, 0.99, length.out = 100),
  adaptive = FALSE,
  seed = 123
)
}
\arguments{
\item{df}{A matrix or data frame of features (columns) by samples (rows). Transpose if features are rows.}

\item{metadata}{A data frame of sample-level metadata. Must include `outcome_col` and optionally `confounder_cols`.}

\item{outcome_col}{Character. Column name in `metadata` corresponding to the primary outcome variable.}

\item{confounder_cols}{Optional character vector of column names in `metadata` for confounder adjustment.}

\item{basis_df}{Integer. Degrees of freedom for the B-spline basis (default = 6).}

\item{t_grid}{Numeric vector of quantile levels to evaluate (default = 100 values from 0.01 to 0.99).}

\item{adaptive}{Logical. If TRUE, applies adaptive Cauchy combination (default = FALSE).}

\item{seed}{Integer for reproducibility (default = 123).}
}
\value{
A data frame with one row per feature and columns:
\describe{
  \item{OTU}{The feature name (i.e., column name from `df`).}
  \item{p_value}{Cauchy-combined global p-value testing association with the outcome.}
  \item{auc}{Area under the effect curve.}
  \item{abs_auc}{Area under the absolute effect curve.}
  \item{adj_p_value}{Bonferroni-adjusted p-value.}
}
}
\description{
This function performs quantile-based inference on each feature (e.g., taxon) using the Wasserstein spectrum framework.
It estimates the effect of a continuous or binary outcome on feature abundance across quantiles using basis projection,
computes Wald-type test statistics, and aggregates p-values via (adaptive) Cauchy combination.
The function leverages C++ acceleration for efficiency.
}
