% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/wasserstein_test.R
\name{wasserstein_test}
\alias{wasserstein_test}
\title{Permutation-Based Wasserstein Test for Two-Group Alpha Diversity Comparison}
\usage{
wasserstein_test(
  df,
  feature_col,
  group_col,
  nperm = 1000,
  plot = TRUE,
  seed = 123
)
}
\arguments{
\item{df}{A data frame containing the alpha diversity values and group labels.}

\item{feature_col}{A string specifying the column name in \code{df} corresponding to the feature of interest (e.g., taxon, gene, or diversity index).}

\item{group_col}{A string specifying the column name in \code{df} indicating the group variable.
Must have exactly two unique values.}

\item{nperm}{Number of permutations used to generate the null distribution (default is 1000).}

\item{plot}{Logical indicating whether to display a histogram of the null distribution
with the observed statistic marked (default is \code{TRUE}).}

\item{seed}{An integer seed for reproducibility (default is 123).}
}
\value{
A list with the following components:
\item{statistic}{Observed Wasserstein distance between the two groups.}
\item{p_value}{Permutation p-value comparing observed statistic to null distribution.}
\item{null_distribution}{A numeric vector containing the permuted test statistics.}
}
\description{
Performs a two-sample hypothesis test for distributional differences in alpha diversity
between two groups using the 1D Wasserstein distance (also known as Earth Moverâ€™s Distance).
This test is robust to ties and sensitive to shifts in location, scale, and shape of the
diversity distribution. The null distribution is generated via permutation of group labels.
}
\details{
The test computes the 1D Wasserstein distance between the empirical distributions
of the alpha diversity values in the two groups. A permutation-based p-value is calculated
by comparing the observed distance to the distribution of distances obtained from permuted group labels.

This approach is particularly well-suited to microbiome studies, where diversity distributions
may exhibit heavy ties, skewness, and heterogeneity that are poorly captured by traditional
location-based tests.
}
\examples{
\dontrun{
result <- wasserstein_test(df = example_df, feature_col = "Shannon", group_col = "Group")
print(result$p_value)
}

}
