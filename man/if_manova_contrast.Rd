% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/if_manova_contrast.R
\name{if_manova_contrast}
\alias{if_manova_contrast}
\title{Interval-Wise MANOVA Contrast Test for Spectrum Curves}
\usage{
if_manova_contrast(spectrum_obj, a, b, contrast = NULL)
}
\arguments{
\item{spectrum_obj}{An object returned by \code{\link{wasserstein_spectrum_multiclass}}, containing
estimated group-level coefficients, basis matrix, and robust variance-covariance matrix.}

\item{a}{Lower bound of the quantile interval \eqn{a \in (0, 1)}.}

\item{b}{Upper bound of the quantile interval \eqn{b \in (0, 1)}, where \code{b > a}.}

\item{contrast}{Optional contrast vector or matrix (rows as group comparisons).
If \code{NULL} (default), performs a global test across all non-reference groups.}
}
\value{
A list with the following components:
\item{statistic}{The Wald statistic (Hotelling-type \eqn{T^2}) for the contrast.}
\item{df}{Degrees of freedom for the test (number of contrast rows).}
\item{p_value}{P-value from the chi-squared distribution.}
\item{contrast}{The contrast matrix used for the test.}
\item{estimate}{The estimated contrast effect (linear combination of integrated group curves).}
\item{cov_estimate}{Covariance matrix of the estimated contrast effect.}
}
\description{
Performs a Wald-type contrast test over a specified quantile interval \eqn{[a, b]} to assess whether
the integrated group-level spectrum curves differ significantly. This function is based on the output
of \code{\link{wasserstein_spectrum_multiclass}}.
}
\details{
This function tests whether the **integrated spectrum curves** differ between groups
over the interval \eqn{[a, b]}. The contrast matrix defines the comparison structure
(e.g., pairwise or global). If omitted, the function returns a global test comparing
all groups versus the reference.

The Wald test statistic is:
\deqn{
T^2 = \theta^\top \mathrm{Var}^{-1}(\theta) \theta,
}
where \(\theta = C \int_a^b \beta(t)\,dt\).
}
\examples{
\dontrun{
# Global test over middle quantiles
fit <- wasserstein_spectrum_multiclass(...)
test <- if_manova_contrast(fit, a = 0.2, b = 0.8)

# Pairwise contrast
pairwise <- c(1, -1, 0)  # group 1 vs group 2
test2 <- if_manova_contrast(fit, a = 0.2, b = 0.8, contrast = pairwise)
}

}
