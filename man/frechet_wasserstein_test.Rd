% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/frechet_wasserstein_test.R
\name{frechet_wasserstein_test}
\alias{frechet_wasserstein_test}
\title{Fréchet–Wasserstein Test for Multi-Group Alpha Diversity Comparison}
\usage{
frechet_wasserstein_test(
  df,
  feature_col,
  group_col,
  nperm = 1000,
  plot = TRUE,
  seed = 123
)
}
\arguments{
\item{df}{A data frame containing the alpha diversity values and group labels.}

\item{feature_col}{A string specifying the column name in \code{df} corresponding to the feature of interest (e.g., taxon, gene, or diversity index).}

\item{group_col}{A string specifying the column name in \code{df} that indicates the group variable. Must have at least two unique levels.}

\item{nperm}{Number of permutations used to generate the null distribution (default is 1000).}

\item{plot}{Logical. If \code{TRUE}, displays a histogram of the null distribution with the observed test statistic (default is \code{TRUE}).}

\item{seed}{An integer to set the random seed for reproducibility (default is 123).}
}
\value{
A list with the following components:
\item{T_obs}{Observed Fréchet–Wasserstein test statistic, measuring total group-wise dispersion.}
\item{p_value}{Permutation p-value comparing \code{T_obs} to the null distribution.}
\item{T_null}{A numeric vector containing the permuted test statistics under the null hypothesis.}
}
\description{
Performs a permutation-based test for comparing alpha diversity distributions across
multiple groups using the Fréchet variance in Wasserstein space. This method generalizes
the two-sample Wasserstein test to \(G > 2\) groups by quantifying the group-wise
dispersion around a shared Wasserstein barycenter.
}
\details{
The Fréchet–Wasserstein test extends classical ANOVA to the space of distributions by computing
the squared Wasserstein distances between group-wise quantile functions and their shared barycenter.
The observed statistic is compared to a null distribution obtained by permuting group labels,
providing a robust and distribution-free inference procedure. This method is particularly suited
to microbiome studies, where diversity values often exhibit ties, skewness, or non-Gaussian behavior.
}
\examples{
\dontrun{
result <- frechet_wasserstein_test(df = example_df,
                                   feature_col = "Shannon",
                                   group_col = "Group")
print(result$p_value)
}

}
