% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/wasserstein_spectrum_multiclass.R
\name{wasserstein_spectrum_multiclass}
\alias{wasserstein_spectrum_multiclass}
\title{Multiclass Wasserstein Spectrum Regression via Generalized Least Squares (GLS)}
\usage{
wasserstein_spectrum_multiclass(
  df,
  diversity_col,
  outcome_col,
  reference_level,
  confounder_cols = NULL,
  basis_df = 6,
  t_grid = seq(0.01, 0.99, length.out = 100),
  alpha = 0.05,
  plot = TRUE,
  seed = 123
)
}
\arguments{
\item{df}{A data frame containing the diversity index, exposure variable, and optional confounders.}

\item{diversity_col}{A string specifying the column name of the continuous alpha diversity index.}

\item{outcome_col}{A string specifying the name of the categorical exposure variable (with \code{K >= 2} levels).}

\item{reference_level}{A string indicating which level of the exposure variable to use as the reference group.}

\item{confounder_cols}{Optional character vector of column names to include as covariates (default is \code{NULL}).}

\item{basis_df}{Degrees of freedom for the B-spline basis expansion across quantiles (default is 6).}

\item{t_grid}{Numeric vector of quantile levels \eqn{t \in (0, 1)} to evaluate (default is 100 points from 0.01 to 0.99).}

\item{alpha}{Significance level for constructing confidence intervals (default is 0.05).}

\item{plot}{Logical. If \code{TRUE}, returns a faceted ggplot visualizing the contrast curves (default is \code{TRUE}).}

\item{seed}{Integer seed for reproducibility (default is 123).}
}
\value{
A list containing:
\item{quantiles}{Quantile levels used in the regression.}
\item{beta}{A matrix of estimated contrast curves \(\hat{\beta}_k(t)\) for each comparison group (rows) across quantiles (columns).}
\item{se}{Matrix of standard errors for the estimated curves.}
\item{lower}{Lower bounds of the \((1 - \alpha)\)-level confidence intervals.}
\item{upper}{Upper bounds of the \((1 - \alpha)\)-level confidence intervals.}
\item{comparison_levels}{Names of the non-reference levels being contrasted.}
\item{reference_level}{The reference level used in contrast coding.}
\item{basis}{B-spline basis matrix used for quantile expansion.}
\item{coef}{Estimated coefficients from the GLS fit.}
\item{vcov}{Robust variance-covariance matrix of the estimated coefficients.}
\item{plot}{A \code{ggplot} object showing the spectrum plot if \code{plot = TRUE}, otherwise \code{NULL}.}
}
\description{
Estimates the quantile-resolved effect of a categorical exposure variable on alpha diversity
using functional regression with basis expansion and GLS. The model captures group-specific
contrast curves \eqn{\beta_k(t)} comparing each level to the user-defined reference group.
}
\details{
This function generalizes the binary GLS spectrum regression to multiclass exposures. At each quantile threshold,
binary outcomes are defined based on whether the diversity index falls below the threshold.
B-spline basis expansion is used to parameterize smooth group-level effects \(\beta_k(t)\), and
coefficient curves are estimated using generalized least squares with robust (sandwich) standard errors.

The output enables inference and visualization of how different groups differ across the spectrum of diversity.
}
\examples{
\dontrun{
result <- wasserstein_spectrum_multiclass(
  df = example_df,
  diversity_col = "Shannon",
  outcome_col = "DiseaseGroup",
  reference_level = "Healthy",
  confounder_cols = c("Age", "Sex")
)
result$plot
}

}
