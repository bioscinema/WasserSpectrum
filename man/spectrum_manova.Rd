% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/spectrum_manova.R
\name{spectrum_manova}
\alias{spectrum_manova}
\title{Spectrum-Based MANOVA (Hotelling-Type Test) for Multiclass GLS Regression}
\usage{
spectrum_manova(spectrum_obj)
}
\arguments{
\item{spectrum_obj}{An object returned by \code{\link{wasserstein_spectrum_multiclass}},
containing estimated contrast curves, robust covariance matrix, and spline basis matrix.}
}
\value{
A data frame with the following columns:
\item{quantile}{The quantile level \(t\) at which the test is performed.}
\item{Fval}{The Hotelling-type test statistic at each quantile.}
\item{pval}{The corresponding p-value under an F-distribution with \code{df1 = K - 1} and \code{df2 = Inf}.}
}
\description{
Performs a Hotelling-type test at each quantile to assess whether group-level contrast curves
\eqn{\beta_k(t)} jointly differ from zero. This function applies to results from
\code{\link{wasserstein_spectrum_multiclass}}.
}
\details{
For each quantile level \eqn{t_j}, the function tests the null hypothesis that
all group-level contrast effects \eqn{\beta_k(t_j)} are simultaneously zero.
The test statistic is a scaled version of Hotellingâ€™s \(T^2\), adapted for robust covariance:
\deqn{
F(t_j) = \frac{1}{K - 1} \beta(t_j)^\top \Sigma^{-1}(t_j) \beta(t_j),
}
where \(\Sigma(t_j)\) is the estimated covariance matrix of \(\beta(t_j)\).

This procedure yields a quantile-wise map of where multigroup differences are strongest.
}
\examples{
\dontrun{
fit <- wasserstein_spectrum_multiclass(
  df = example_df,
  feature_col = "Shannon",
  outcome_col = "Group",
  reference_level = "Healthy",
  confounder_cols = c("Age", "Sex")
)
manova_result <- spectrum_manova(fit)
plot(manova_result$quantile, -log10(manova_result$pval), type = "l")
}

}
